# ComplexMap ![ComplexMap hex logo](reference/figures/ComplexMap_logo.png)

[![Lifecycle:
stable](https://img.shields.io/badge/lifecycle-stable-green.svg)](https://lifecycle.r-lib.org/articles/stages.html)
[![License:
MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

**ComplexMap** is an R package that provides a complete, end-to-end
workflow for the analysis of protein complex datasets. It is designed to
take a raw list of putative protein complexes and transform it into a
fully annotated, publication-ready functional map.

## Core Features

- **Integrated Workflow:** Go from a raw complex list to a final network
  map with a single function,
  [`createComplexMap()`](https://zqzneptune.github.io/ComplexMap/reference/createComplexMap.md).

- **Quality Control & Refinement:** Automatically filter complexes by
  size and merge redundant groups to create a clean, non-redundant
  dataset.

- **Functional Enrichment:** Annotate complexes using gene sets from
  local files, MSigDB, Gene Ontology, or Reactome.

- **Powerful Visualizations:** Generate static (ggplot2) and interactive
  (visNetwork) plots to explore the functional landscape.

- **Quantitative Analysis:** Summarize biological themes using community
  detection and programmatically query the map for specific proteins,
  complexes, or themes.

- **Benchmarking:** Quantitatively evaluate your predicted complexes
  against a reference standard like CORUM.

------------------------------------------------------------------------

## Installation

You can install the stable version of **ComplexMap** from GitHub. The
installer will automatically handle all required dependencies from CRAN
and Bioconductor.

``` r

# If you don't have remotes installed: install.packages("remotes")
remotes::install_github("zqzneptune/ComplexMap")
```

------------------------------------------------------------------------

## Workflow at a Glance

This example demonstrates the core workflow: analyzing the included
human protein complex dataset and generating a functional map with a
single command.

``` r

library(ComplexMap)

# 1. Load the example complex list and a gene set file
utils::data("demoComplexes")
gmt_file <- ComplexMap::getExampleGmt()
gmt <- ComplexMap::getGmtFromFile(gmt_file, verbose = FALSE)

# 2. Run the entire workflow
# We can pass arguments to underlying functions, like `mergeThreshold`, directly.
cm_obj <- ComplexMap::createComplexMap(
  complexList = demoComplexes,
  gmt = gmt,
  mergeThreshold = 0.8,
  verbose = FALSE # Set to TRUE to see workflow steps
)

# 3. Print the resulting object for a high-level summary
cm_obj
#> # A ComplexMap Object
#> ── 490 nodes and 12931 edges
#> ── 15 major biological themes identified.
#> ── Use `getNodeTable()` or `getEdgeTable()` to access data.

# 4. Visualize the map
node_tbl <- ComplexMap::getNodeTable(cm_obj)
edge_tbl <- ComplexMap::getEdgeTable(cm_obj)

ComplexMap::visualizeMapWithLegend(node_tbl, edge_tbl, verbose = FALSE)
```

![](reference/figures/README-example.png)

------------------------------------------------------------------------

## Exploring the Results

The `ComplexMap` object can be easily analyzed with downstream
functions.

### Summarize Biological Themes

Identify the major biological themes (network modules) using community
detection.

``` r

theme_summary <- ComplexMap::summarizeThemes(cm_obj, verbose = FALSE)

# Show the 10 largest themes
dplyr::slice_max(theme_summary, n = 10, order_by = nodeCount)
```

### Query the Map

Programmatically find specific complexes of interest.

``` r

# Find the complex with the ID "CpxMap_0001"
result <- ComplexMap::queryMap(cm_obj, query = "CpxMap_0001", type = "complex")

# Show some of its key attributes
dplyr::select(result, complexId, primaryFunctionalDomain, proteinCount, degree)
```

## Citation

If you use ComplexMap in your research, please cite the publication
(link to be added upon publication).

For now, you can cite the package itself:

`Qingzhou Zhang (2025). ComplexMap: A Toolset for the Functional Analysis and Visualization of Protein Complex Data. R package version 1.0.0. https://github.com/zqzneptune/ComplexMap`

## Contributing

Please note that the ComplexMap project is released with a [Contributor
Code of
Conduct](https://contributor-covenant.org/version/2/1/code_of_conduct/code_of_conduct.md).
By contributing to this project, you agree to abide by its terms. We
welcome bug reports, feature requests, and pull requests.

# Package index

## All functions

- [`buildComplexNetwork()`](https://zqzneptune.github.io/ComplexMap/reference/buildComplexNetwork.md)
  : Build a Complex-Complex Interaction Network
- [`computeMapTopology()`](https://zqzneptune.github.io/ComplexMap/reference/computeMapTopology.md)
  : Compute Network Topology and Layout Coordinates
- [`createComplexMap()`](https://zqzneptune.github.io/ComplexMap/reference/createComplexMap.md)
  : Create a Complete Complex Map Object
- [`demoComplexes`](https://zqzneptune.github.io/ComplexMap/reference/demoComplexes.md)
  : Example Protein Complex List
- [`evaluateComplexes()`](https://zqzneptune.github.io/ComplexMap/reference/evaluateComplexes.md)
  : Evaluate Predicted Protein Complexes Against a Reference Set
- [`exportNetwork()`](https://zqzneptune.github.io/ComplexMap/reference/exportNetwork.md)
  : Export a ComplexMap Network for External Tools
- [`generateNodeAttributes()`](https://zqzneptune.github.io/ComplexMap/reference/generateNodeAttributes.md)
  : Generate Node Attributes for a Complex Network
- [`getEdgeTable()`](https://zqzneptune.github.io/ComplexMap/reference/getEdgeTable.md)
  : Get the Edge Table from a ComplexMap Object
- [`getExampleGmt()`](https://zqzneptune.github.io/ComplexMap/reference/getExampleGmt.md)
  : Get the Path to an Example GMT File
- [`getGmtFromFile()`](https://zqzneptune.github.io/ComplexMap/reference/getGmtFromFile.md)
  : Read a GMT File from a Local Path
- [`getGoGmt()`](https://zqzneptune.github.io/ComplexMap/reference/getGoGmt.md)
  : Fetch Gene Ontology (GO) Gene Sets
- [`getMsigdbGmt()`](https://zqzneptune.github.io/ComplexMap/reference/getMsigdbGmt.md)
  : Fetch Gene Sets from MSigDB
- [`getNodeTable()`](https://zqzneptune.github.io/ComplexMap/reference/getNodeTable.md)
  : Get the Node Table from a ComplexMap Object
- [`getReactomeGmt()`](https://zqzneptune.github.io/ComplexMap/reference/getReactomeGmt.md)
  : Fetch Reactome Pathway Gene Sets
- [`print(`*`<ComplexMap>`*`)`](https://zqzneptune.github.io/ComplexMap/reference/print.ComplexMap.md)
  : Print Method for a ComplexMap Object
- [`qcComplexList()`](https://zqzneptune.github.io/ComplexMap/reference/qcComplexList.md)
  : Perform Quality Control on a List of Protein Complexes
- [`queryMap()`](https://zqzneptune.github.io/ComplexMap/reference/queryMap.md)
  : Query a ComplexMap Object for Specific Information
- [`referenceComplexes`](https://zqzneptune.github.io/ComplexMap/reference/referenceComplexes.md)
  : Reference Protein Complex Set (CORUM)
- [`refineComplexList()`](https://zqzneptune.github.io/ComplexMap/reference/refineComplexList.md)
  : Refine a List of Protein Complexes by Size and Redundancy
- [`runComplexEnrichment()`](https://zqzneptune.github.io/ComplexMap/reference/runComplexEnrichment.md)
  : Run Gene Set Enrichment Analysis on a List of Complexes
- [`summarizeThemes()`](https://zqzneptune.github.io/ComplexMap/reference/summarizeThemes.md)
  : Summarize Major Biological Themes in a Complex Map
- [`visualizeMapDirectLabels()`](https://zqzneptune.github.io/ComplexMap/reference/visualizeMapDirectLabels.md)
  : Visualize a Complex Map with Direct Node Labels
- [`visualizeMapInteractive()`](https://zqzneptune.github.io/ComplexMap/reference/visualizeMapInteractive.md)
  : Visualize a Complex Map Interactively
- [`visualizeMapWithLegend()`](https://zqzneptune.github.io/ComplexMap/reference/visualizeMapWithLegend.md)
  : Visualize a Complex Map with a Color Legend

# Articles

### All vignettes

- [1. Preparing Your Input
  Data](https://zqzneptune.github.io/ComplexMap/articles/vignette_01-prep-input.md):
- [2. Start a Typical
  Workflow](https://zqzneptune.github.io/ComplexMap/articles/vignette_02-workflow.md):
- [3. Explore Advanced
  Analyses](https://zqzneptune.github.io/ComplexMap/articles/vignette_03-advanced-analysis.md):
