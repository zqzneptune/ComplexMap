<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3. Explore Advanced Analyses • ComplexMap</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="3. Explore Advanced Analyses">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ComplexMap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vignette_01-prep-input.html">1. Preparing Your Input Data</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_02-workflow.html">2. Start a Typical Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_03-advanced-analysis.html">3. Explore Advanced Analyses</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://zqzneptune.github.io" aria-label="Home page"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zqzneptune/ComplexMap" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>3. Explore Advanced Analyses</h1>
                        <h4 data-toc-skip class="author">Qingzhou
Zhang</h4>
            
            <h4 data-toc-skip class="date">2025-11-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/zqzneptune/ComplexMap/blob/HEAD/vignettes/vignette_03-advanced-analysis.Rmd" class="external-link"><code>vignettes/vignette_03-advanced-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>vignette_03-advanced-analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>While the <code><a href="../reference/createComplexMap.html">ComplexMap::createComplexMap()</a></code> function
provides a seamless, one-step workflow for most use cases, the package
also includes a suite of granular functions for users who require more
control, wish to benchmark their results, or need to export data for
other tools.</p>
<p>This vignette covers these advanced topics:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Granular Workflow Control</strong>: Running the quality
control and refinement steps manually to inspect intermediate
results.</p></li>
<li><p><strong>Benchmarking Predictions</strong>: Using
<code><a href="../reference/evaluateComplexes.html">evaluateComplexes()</a></code> to compare your experimental complexes
against a reference set like CORUM.</p></li>
<li><p><strong>Advanced Network Exploration</strong>: Adding theme
information back to a <code>ComplexMap</code> object to enable powerful,
theme-based queries.</p></li>
<li><p><strong>Interoperability</strong>: Exporting the final network
for visualization and analysis in external software like
Cytoscape.</p></li>
</ol>
<p>We will use the package’s built-in datasets for this
demonstration.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the experimental and reference complex lists</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"demoComplexes"</span>, package <span class="op">=</span> <span class="st">"ComplexMap"</span><span class="op">)</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"referenceComplexes"</span>, package <span class="op">=</span> <span class="st">"ComplexMap"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="granular-workflow-control">1. Granular Workflow Control<a class="anchor" aria-label="anchor" href="#granular-workflow-control"></a>
</h2>
<p>The <code><a href="../reference/createComplexMap.html">createComplexMap()</a></code> function automatically runs
quality control and refinement. However, you can run these steps
manually using the underlying functions to better understand and tune
your analysis.</p>
<div class="section level4">
<h4 id="quality-control">1.1 Quality Control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h4>
<p>First, we can run <code><a href="../reference/qcComplexList.html">qcComplexList()</a></code> on our raw input data
to get a detailed report on complex sizes and redundancy.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the QC function with verbose output</span></span>
<span><span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/qcComplexList.html">qcComplexList</a></span><span class="op">(</span><span class="va">demoComplexes</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Running Quality Control on Complex List ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] Basic Statistics:</span></span>
<span><span class="co">#&gt;     - Total number of complexes: 622</span></span>
<span><span class="co">#&gt;     - Total number of unique proteins: 2649</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [2] Complex Size Distribution:</span></span>
<span><span class="co">#&gt;        Min. 1st Qu.  Median    Mean 3rd Qu.    Max.</span></span>
<span><span class="co">#&gt;       1.000   3.000   4.000   5.183   5.000 102.000</span></span>
<span><span class="co">#&gt; Warning in ComplexMap::qcComplexList(demoComplexes): 112 complexes have fewer</span></span>
<span><span class="co">#&gt; than 3 members.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [3] Redundancy Analysis:</span></span>
<span><span class="co">#&gt;     - Distribution of Jaccard similarity scores:</span></span>
<span><span class="co">#&gt;          Min.   1st Qu.    Median      Mean   3rd Qu.      Max.</span></span>
<span><span class="co">#&gt;     0.0000000 0.0000000 0.0000000 0.0003226 0.0000000 0.5000000</span></span>
<span><span class="co">#&gt;     - No highly redundant complex pairs detected.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- QC Complete ---</span></span></code></pre></div>
<p>The report provides summary statistics and warns us that a number of
complex pairs are highly redundant (Jaccard similarity &gt;= 0.8). This
confirms that the refinement step is necessary.</p>
</div>
<div class="section level4">
<h4 id="manual-refinement">1.2 Manual Refinement<a class="anchor" aria-label="anchor" href="#manual-refinement"></a>
</h4>
<p>Next, we can manually run <code><a href="../reference/refineComplexList.html">refineComplexList()</a></code>. This
allows us to inspect the set of complexes <em>after</em> merging but
<em>before</em> functional enrichment, which can be useful for debugging
or parameter tuning.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Number of complexes before refinement: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">demoComplexes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of complexes before refinement: 622</span></span>
<span></span>
<span><span class="co"># Merge complexes with a Jaccard similarity of 0.75 or higher</span></span>
<span><span class="va">refinedComplexes</span> <span class="op">&lt;-</span> <span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/refineComplexList.html">refineComplexList</a></span><span class="op">(</span></span>
<span>  <span class="va">demoComplexes</span>,</span>
<span>  mergeThreshold <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># Set to TRUE for detailed messages</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Number of complexes after refinement: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">refinedComplexes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of complexes after refinement: 510</span></span></code></pre></div>
<p>Running this step manually gives us direct access to the
<code>refinedComplexes</code> list for further inspection before
proceeding with the rest of the workflow.</p>
</div>
</div>
<div class="section level2">
<h2 id="benchmarking-predictions">2. Benchmarking Predictions<a class="anchor" aria-label="anchor" href="#benchmarking-predictions"></a>
</h2>
<p>For methods development, it is essential to evaluate how well a set
of predicted complexes matches a “gold standard” reference. The
<code><a href="../reference/evaluateComplexes.html">evaluateComplexes()</a></code> function calculates four standard
metrics for this purpose.</p>
<p>We will compare our <code>refinedComplexes</code> against the
<code>referenceComplexes</code> (a curated subset of CORUM).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Evaluate the refined complexes against the reference set</span></span>
<span><span class="va">evaluationMetrics</span> <span class="op">&lt;-</span> <span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/evaluateComplexes.html">evaluateComplexes</a></span><span class="op">(</span></span>
<span>  predictedComplexes <span class="op">=</span> <span class="va">refinedComplexes</span>,</span>
<span>  referenceComplexes <span class="op">=</span> <span class="va">referenceComplexes</span>,</span>
<span>  nCores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the resulting metrics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">evaluationMetrics</span><span class="op">)</span></span>
<span><span class="co">#&gt; $PPV</span></span>
<span><span class="co">#&gt; [1] 0.8005051</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Sn</span></span>
<span><span class="co">#&gt; [1] 0.2510583</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Acc</span></span>
<span><span class="co">#&gt; [1] 0.4483006</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MMR</span></span>
<span><span class="co">#&gt; [1] 0.09403458</span></span></code></pre></div>
<ul>
<li><p><strong>PPV</strong> (Positive Predictive Value): Measures the
accuracy of your predictions.</p></li>
<li><p><strong>Sn</strong> (Sensitivity): Measures the coverage of the
reference set.</p></li>
<li><p><strong>Acc</strong> (Accuracy): The geometric mean of PPV and
Sn.</p></li>
<li><p><strong>MMR</strong> (Maximum Matching Ratio): A score based on
finding the best one-to-one mapping between predicted and reference
complexes.</p></li>
</ul>
<p>These metrics provide a quantitative assessment of your complex
prediction quality.</p>
</div>
<div class="section level2">
<h2 id="advanced-network-exploration-querying-by-theme">3. Advanced Network Exploration: Querying by Theme<a class="anchor" aria-label="anchor" href="#advanced-network-exploration-querying-by-theme"></a>
</h2>
<p>In the main workflow vignette, we used <code><a href="../reference/summarizeThemes.html">summarizeThemes()</a></code>
to get a table of biological themes. A powerful advanced technique is to
add this theme information back into the <code>ComplexMap</code> object
itself, enabling direct queries.</p>
<p>First, let’s generate a <code>ComplexMap</code> object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gmtPath</span> <span class="op">&lt;-</span> <span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/getExampleGmt.html">getExampleGmt</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gmt</span> <span class="op">&lt;-</span> <span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/getGmtFromFile.html">getGmtFromFile</a></span><span class="op">(</span><span class="va">gmtPath</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We use the manually refined list as input</span></span>
<span><span class="va">cm_obj</span> <span class="op">&lt;-</span> <span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/createComplexMap.html">createComplexMap</a></span><span class="op">(</span></span>
<span>  complexList <span class="op">=</span> <span class="va">refinedComplexes</span>,</span>
<span>  gmt <span class="op">=</span> <span class="va">gmt</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Metric: 'jaccard' with unit: 'log'; comparing: 231 vectors</span></span></code></pre></div>
<p>Now, we generate the themes and add the theme assignments to our node
table.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate the theme summary to get theme labels</span></span>
<span><span class="va">theme_summary</span> <span class="op">&lt;-</span> <span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/summarizeThemes.html">summarizeThemes</a></span><span class="op">(</span><span class="va">cm_obj</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To get the theme assignment for each node, we must re-run community detection</span></span>
<span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/getNodeTable.html">getNodeTable</a></span><span class="op">(</span><span class="va">cm_obj</span><span class="op">)</span></span>
<span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/getEdgeTable.html">getEdgeTable</a></span><span class="op">(</span><span class="va">cm_obj</span><span class="op">)</span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">edges</span>, vertices <span class="op">=</span> <span class="va">nodes</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">communities</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/cluster_louvain.html" class="external-link">cluster_louvain</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a mapping from themeId (integer) to themeLabel (character)</span></span>
<span><span class="va">theme_map</span> <span class="op">&lt;-</span> <span class="va">theme_summary</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"themeId"</span>, <span class="st">"themeLabel"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Add theme ID and label columns to our node table</span></span>
<span><span class="va">nodes</span><span class="op">$</span><span class="va">themeId</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/communities.html" class="external-link">membership</a></span><span class="op">(</span><span class="va">communities</span><span class="op">)</span></span>
<span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">nodes</span>, <span class="va">theme_map</span>, by <span class="op">=</span> <span class="st">"themeId"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># **Crucially, update the object with the new node information**</span></span>
<span><span class="va">cm_obj</span><span class="op">$</span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="va">nodes</span></span></code></pre></div>
<p>With the prepared object, we can now find all complexes belonging to
a specific theme, for example, the “26S Proteasome”.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To make the example robust, we query for a theme label that we know</span></span>
<span><span class="co"># exists because we just generated it in the `theme_summary` table.</span></span>
<span><span class="va">query_label</span> <span class="op">&lt;-</span> <span class="va">theme_summary</span><span class="op">$</span><span class="va">themeLabel</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Dynamically querying for a theme found in the map: "</span>, <span class="va">query_label</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dynamically querying for a theme found in the map: BIOCARTA_EICOSANOID_PATHWAYBIOCARTA_EICOSANOID_PATHWAYBIOCARTA_EICOSANOID_PATHWAYBIOCARTA_EICOSANOID_PATHWAYBIOCARTA_EICOSANOID_PATHWAYBIOCARTA_EICOSANOID_PATHWAYBIOCARTA_SAM68_PATHWAYBIOCARTA_ETS_PATHWAYBIOCARTA_EICOSANOID_PATHWAYBIOCARTA_EICOSANOID_PATHWAYBIOCARTA_EICOSANOID_PATHWAYBIOCARTA_EICOSANOID_PATHWAYBIOCARTA_EPONFKB_PATHWAYBIOCARTA_MRP_PATHWAYBIOCARTA_EICOSANOID_PATHWAYBIOCARTA_EICOSANOID_PATHWAYMixed or UnenrichedMixed or UnenrichedBIOCARTA_MCM_PATHWAYBIOCARTA_RAB_PATHWAYBIOCARTA_EICOSANOID_PATHWAYMixed or UnenrichedBIOCARTA_NUCLEARRS_PATHWAYBIOCARTA_S1P_PATHWAYMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedBIOCARTA_GABA_PATHWAYMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedBIOCARTA_LDL_PATHWAYMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedMixed or UnenrichedBIOCARTA_ARAP_PATHWAYMixed or UnenrichedMixed or UnenrichedMixed or Unenriched</span></span>
<span></span>
<span><span class="va">theme_complexes</span> <span class="op">&lt;-</span> <span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/queryMap.html">queryMap</a></span><span class="op">(</span></span>
<span>  <span class="va">cm_obj</span>,</span>
<span>  query <span class="op">=</span> <span class="va">query_label</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"theme"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in nodes$themeLabel == query: longer object length is not a multiple of</span></span>
<span><span class="co">#&gt; shorter object length</span></span>
<span></span>
<span><span class="co"># Show the results</span></span>
<span><span class="va">theme_complexes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">complexId</span>, <span class="va">themeLabel</span>, <span class="va">proteinCount</span>, <span class="va">betweenness</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 114 × 4</span></span></span>
<span><span class="co">#&gt;    complexId   themeLabel                  proteinCount betweenness</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> CpxMap_0359 BIOCARTA_EICOSANOID_PATHWAY            5      0.154 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> CpxMap_0414 BIOCARTA_EICOSANOID_PATHWAY            8      0.136 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> CpxMap_0508 BIOCARTA_EICOSANOID_PATHWAY           42      0.111 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> CpxMap_0401 BIOCARTA_EICOSANOID_PATHWAY            6      0.100 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> CpxMap_0509 BIOCARTA_EICOSANOID_PATHWAY          102      0.091<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> CpxMap_0090 BIOCARTA_EICOSANOID_PATHWAY            4      0.088<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> CpxMap_0143 BIOCARTA_EICOSANOID_PATHWAY            4      0.070<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> CpxMap_0182 BIOCARTA_EICOSANOID_PATHWAY            4      0.065<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> CpxMap_0501 BIOCARTA_EICOSANOID_PATHWAY           20      0.059<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> CpxMap_0372 BIOCARTA_EICOSANOID_PATHWAY            6      0.054<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 104 more rows</span></span></span></code></pre></div>
<p>This technique provides a powerful way to programmatically subset and
analyze the biological modules within your map.</p>
</div>
<div class="section level2">
<h2 id="interoperability-exporting-to-cytoscape">4. Interoperability: Exporting to Cytoscape<a class="anchor" aria-label="anchor" href="#interoperability-exporting-to-cytoscape"></a>
</h2>
<p>While <code>ComplexMap</code> provides excellent internal
visualizations, you may want to use other powerful tools like <a href="https://cytoscape.org/" class="external-link">Cytoscape</a> for advanced analysis,
network manipulation, or creating publication-quality figures.</p>
<p>The <code><a href="../reference/exportNetwork.html">exportNetwork()</a></code> function writes the node and edge
tables to disk as tab-separated files (<code>.tsv</code>), which can be
easily imported into Cytoscape.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use a temporary directory for this example</span></span>
<span><span class="va">temp_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">file_prefix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">temp_dir</span>, <span class="st">"human_complex_map"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export the network</span></span>
<span><span class="fu">ComplexMap</span><span class="fu">::</span><span class="fu"><a href="../reference/exportNetwork.html">exportNetwork</a></span><span class="op">(</span><span class="va">cm_obj</span>, filePrefix <span class="op">=</span> <span class="va">file_prefix</span><span class="op">)</span></span>
<span><span class="co">#&gt; Exporting network in Cytoscape format to:</span></span>
<span><span class="co">#&gt;  -&gt; /var/folders/x8/ngpdbcfd3pj5sf3r9kkxgs740000gn/T//RtmpZDxIxh/human_complex_map_nodes.tsv</span></span>
<span><span class="co">#&gt;  -&gt; /var/folders/x8/ngpdbcfd3pj5sf3r9kkxgs740000gn/T//RtmpZDxIxh/human_complex_map_edges.tsv</span></span>
<span><span class="co">#&gt; Export complete.</span></span>
<span></span>
<span><span class="co"># List the files that were created</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">temp_dir</span>, pattern <span class="op">=</span> <span class="st">"human_complex_map"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "human_complex_map_edges.tsv" "human_complex_map_nodes.tsv"</span></span></code></pre></div>
<p>To use these in Cytoscape, you would:</p>
<ol style="list-style-type: decimal">
<li><p>Go to <code>File &gt; Import &gt; Network from File...</code> and
select the <code>_edges.tsv</code> file.</p></li>
<li><p>In the mapping dialog, map the <code>source_complex_id</code>
column to “Source Node” and <code>target_complex_id</code> to “Target
Node”.</p></li>
<li><p>Once the network is loaded, go to
<code>File &gt; Import &gt; Table from File...</code> and select the
<code>_nodes.tsv</code> file.</p></li>
<li><p>Ensure the “Key column for network” is set to
<code>complexId</code>.</p></li>
</ol>
<p>This will import all your node attributes (colors, sizes, functional
domains, etc.) and map them directly onto your network.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette has demonstrated the advanced capabilities of the
<code>ComplexMap</code> package. Beyond the simple one-step workflow,
the package provides granular functions for quality control, rigorous
benchmarking tools for methods development, and powerful utilities for
deep, theme-based querying and exporting results to other platforms.
This layered functionality makes <code>ComplexMap</code> a comprehensive
toolkit for both novice and expert users.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Qingzhou Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
