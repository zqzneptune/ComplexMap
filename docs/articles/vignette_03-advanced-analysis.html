<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3. Advanced Analysis and Visualization • ComplexMap</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="3. Advanced Analysis and Visualization">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ComplexMap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vignette_01-prep-input.html">1. Preparing Your Input Data</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_02-workflow.html">2. Start a Typical Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_03-advanced-analysis.html">3. Advanced Analysis and Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_04-quantitative-visualization.html">4. Visualizing Quantitative Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://zqzneptune.github.io" aria-label="Home page"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zqzneptune/ComplexMap" aria-label="GitHub repository"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>3. Advanced Analysis and Visualization</h1>
                        <h4 data-toc-skip class="author">Qingzhou
Zhang</h4>
            
            <h4 data-toc-skip class="date">2025-11-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/zqzneptune/ComplexMap/blob/HEAD/vignettes/vignette_03-advanced-analysis.Rmd" class="external-link"><code>vignettes/vignette_03-advanced-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>vignette_03-advanced-analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="advanced-analysis-workflow">Advanced Analysis Workflow<a class="anchor" aria-label="anchor" href="#advanced-analysis-workflow"></a>
</h2>
<p>Once you have a <code>ComplexMap</code> object, the package provides
several functions for deeper analysis and interpretation of the network
structure. This vignette covers:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Optimizing Parameters</strong>: Using
<code><a href="../reference/evaluateComplexes.html">evaluateComplexes()</a></code> to tune the
<code>refineComplexList</code> step.</p></li>
<li><p><strong>Summarizing Themes</strong>: Using
<code><a href="../reference/summarizeThemes.html">summarizeThemes()</a></code> to identify major biological
clusters.</p></li>
<li><p><strong>Querying the Map</strong>: Using <code><a href="../reference/queryMap.html">queryMap()</a></code>
to find specific proteins, complexes, or themes.</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://zqzneptune.github.io/ComplexMap">ComplexMap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="optimizing-refinement-with-evaluatecomplexes">1. Optimizing Refinement with <code>evaluateComplexes</code><a class="anchor" aria-label="anchor" href="#optimizing-refinement-with-evaluatecomplexes"></a>
</h3>
<p>The <code>mergeThreshold</code> in <code>refineComplexList</code> is
a critical parameter that determines how aggressively smaller complexes
are merged. A low threshold creates fewer, larger complexes, while a
high threshold preserves more distinct complexes. The optimal value
often depends on the dataset.</p>
<p>The <code><a href="../reference/evaluateComplexes.html">evaluateComplexes()</a></code> function can be used to score a
refined complex list against a gold standard (like the
<code>referenceComplexes</code> dataset) to help guide this choice. It
returns four key metrics: Positive Predictive Value (PPV), Sensitivity
(Sn), Accuracy (Acc), and Maximum Matching Ratio (MMR).</p>
<p>Let’s test a <code>mergeThreshold</code> of 0.85.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the package's demo and reference data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">demoComplexes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">referenceComplexes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># refineComplexList now returns a list with two elements</span></span>
<span><span class="va">refinement_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/refineComplexList.html">refineComplexList</a></span><span class="op">(</span></span>
<span>  <span class="va">demoComplexes</span>,</span>
<span>  mergeThreshold <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># We must now explicitly use the `$refinedComplexes` element for evaluation</span></span>
<span><span class="va">metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluateComplexes.html">evaluateComplexes</a></span><span class="op">(</span></span>
<span>  predictedComplexes <span class="op">=</span> <span class="va">refinement_output</span><span class="op">$</span><span class="va">refinedComplexes</span>,</span>
<span>  referenceComplexes <span class="op">=</span> <span class="va">referenceComplexes</span>,</span>
<span>  nCores <span class="op">=</span> <span class="fl">2</span>, <span class="co"># &lt;-- THIS IS THE FIX: Limit cores for check environment</span></span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the resulting metrics</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">PPV</th>
<th align="right">Sn</th>
<th align="right">Acc</th>
<th align="right">MMR</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.8005051</td>
<td align="right">0.2510583</td>
<td align="right">0.4483006</td>
<td align="right">0.0940346</td>
</tr></tbody>
</table>
<p>For more systematic tuning, see the documentation for the new
<code><a href="../reference/benchmarkParameters.html">benchmarkParameters()</a></code> function, which automates this
process over a range of thresholds.</p>
</div>
<div class="section level3">
<h3 id="summarizing-biological-themes">2. Summarizing Biological Themes<a class="anchor" aria-label="anchor" href="#summarizing-biological-themes"></a>
</h3>
<p>A key goal of <code>ComplexMap</code> is to organize complexes into a
functional landscape. The <code><a href="../reference/summarizeThemes.html">summarizeThemes()</a></code> function uses
network community detection algorithms (like Louvain, the default) to
find densely connected clusters of complexes within the map. It then
automatically labels each cluster based on the most common functional
annotation among its members.</p>
<p>Let’s generate a map with a slightly lower merge threshold to create
a more interconnected network for this example.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We'll use the example GMT file that comes with the package</span></span>
<span><span class="va">gmtPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getExampleGmt.html">getExampleGmt</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gmt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGmtFromFile.html">getGmtFromFile</a></span><span class="op">(</span><span class="va">gmtPath</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the map object</span></span>
<span><span class="va">cm_obj_adv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createComplexMap.html">createComplexMap</a></span><span class="op">(</span></span>
<span>  complexList <span class="op">=</span> <span class="va">demoComplexes</span>,</span>
<span>  gmt <span class="op">=</span> <span class="va">gmt</span>,</span>
<span>  mergeThreshold <span class="op">=</span> <span class="fl">0.75</span>, <span class="co"># Lower threshold for more connections</span></span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now, we can run <code><a href="../reference/summarizeThemes.html">summarizeThemes()</a></code> on this object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The function returns a tibble summarizing each detected theme</span></span>
<span><span class="va">theme_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summarizeThemes.html">summarizeThemes</a></span><span class="op">(</span><span class="va">cm_obj_adv</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the largest themes</span></span>
<span><span class="va">theme_summary</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">nodeCount</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">themeId</th>
<th align="left">themeLabel</th>
<th align="right">nodeCount</th>
<th align="right">edgeCount</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">BIOCARTA_PTDINS_PATHWAY</td>
<td align="right">56</td>
<td align="right">180</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">47</td>
<td align="right">86</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">45</td>
<td align="right">68</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">31</td>
<td align="right">68</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">27</td>
<td align="right">47</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">25</td>
<td align="right">78</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">25</td>
<td align="right">92</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">24</td>
<td align="right">101</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">20</td>
<td align="right">49</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">BIOCARTA_CACAM_PATHWAY</td>
<td align="right">20</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p>This summary shows us the major biological stories in our dataset,
such as the large “Ribosome” and “Proteasome” communities.</p>
</div>
<div class="section level3">
<h3 id="querying-the-map-for-specific-information">3. Querying the Map for Specific Information<a class="anchor" aria-label="anchor" href="#querying-the-map-for-specific-information"></a>
</h3>
<p>The <code><a href="../reference/queryMap.html">queryMap()</a></code> function provides an easy way to retrieve
specific nodes from the <code>ComplexMap</code> object based on
different criteria.</p>
<div class="section level4">
<h4 id="query-by-protein">Query by Protein<a class="anchor" aria-label="anchor" href="#query-by-protein"></a>
</h4>
<p>Find all complexes that contain a specific protein.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find all complexes containing the protein "UBA1"</span></span>
<span><span class="fu"><a href="../reference/queryMap.html">queryMap</a></span><span class="op">(</span><span class="va">cm_obj_adv</span>, query <span class="op">=</span> <span class="st">"UBA1"</span>, type <span class="op">=</span> <span class="st">"protein"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">complexId</span>, <span class="va">primaryFunctionalDomain</span>, <span class="va">proteinCount</span>, <span class="va">proteins</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="7%">
<col width="17%">
<col width="8%">
<col width="66%">
</colgroup>
<thead><tr class="header">
<th align="left">complexId</th>
<th align="left">primaryFunctionalDomain</th>
<th align="right">proteinCount</th>
<th align="left">proteins</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CpxMap_0497</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">18</td>
<td align="left">UBA1,TRMT1,RARS1,QARS1,NARS1,MARS1,LARS1,KARS1,IARS1,GARS1,EPRS1,DARS1,AARS1,VBP1,EEF1E1,ASNS,AIMP2,AIMP1</td>
</tr>
<tr class="even">
<td align="left">CpxMap_0195</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">4</td>
<td align="left">WDR73,USH1C,UBA1,NMD3</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="query-by-complex-id">Query by Complex ID<a class="anchor" aria-label="anchor" href="#query-by-complex-id"></a>
</h4>
<p>Retrieve the data for a single complex.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the data for complex "CpxMap_0001"</span></span>
<span><span class="fu"><a href="../reference/queryMap.html">queryMap</a></span><span class="op">(</span><span class="va">cm_obj_adv</span>, query <span class="op">=</span> <span class="st">"CpxMap_0001"</span>, type <span class="op">=</span> <span class="st">"complex"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="8%">
<col width="8%">
<col width="11%">
<col width="16%">
<col width="14%">
<col width="6%">
<col width="8%">
<col width="6%">
<col width="6%">
<col width="8%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">complexId</th>
<th align="right">proteinCount</th>
<th align="left">proteins</th>
<th align="left">primaryFunctionalDomain</th>
<th align="left">topEnrichedFunctions</th>
<th align="left">colorHex</th>
<th align="right">sizeMapping</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">betweenness</th>
<th align="right">degree</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">CpxMap_0001</td>
<td align="right">3</td>
<td align="left">WDR82,ULK3,UCHL1</td>
<td align="left">Unenriched</td>
<td align="left">NA</td>
<td align="left">#CCCCCC</td>
<td align="right">1.584963</td>
<td align="right">6.421011</td>
<td align="right">-14.1341</td>
<td align="right">0</td>
<td align="right">0</td>
</tr></tbody>
</table>
</div>
<div class="section level4">
<h4 id="query-by-theme">Query by Theme<a class="anchor" aria-label="anchor" href="#query-by-theme"></a>
</h4>
<p>To query by theme, we first need to add the theme labels from
<code><a href="../reference/summarizeThemes.html">summarizeThemes()</a></code> back into our main
<code>ComplexMap</code> object’s node table.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To add the theme labels to our main node table for querying or visualization,</span></span>
<span><span class="co"># we first need to get the theme ID for each node.</span></span>
<span></span>
<span><span class="co"># Re-run the community detection to get the membership vector</span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_data_frame.html" class="external-link">graph_from_data_frame</a></span><span class="op">(</span></span>
<span>  d <span class="op">=</span> <span class="fu"><a href="../reference/getEdgeTable.html">getEdgeTable</a></span><span class="op">(</span><span class="va">cm_obj_adv</span><span class="op">)</span>, </span>
<span>  vertices <span class="op">=</span> <span class="fu"><a href="../reference/getNodeTable.html">getNodeTable</a></span><span class="op">(</span><span class="va">cm_obj_adv</span><span class="op">)</span>, </span>
<span>  directed <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">communities</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/cluster_louvain.html" class="external-link">cluster_louvain</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a tibble mapping complexId to themeId</span></span>
<span><span class="co"># Coerce the 'membership' object to a simple integer for joining</span></span>
<span><span class="va">node_themes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  complexId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/communities.html" class="external-link">membership</a></span><span class="op">(</span><span class="va">communities</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  themeId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/communities.html" class="external-link">membership</a></span><span class="op">(</span><span class="va">communities</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">theme_summary</span><span class="op">$</span><span class="va">themeId</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">theme_summary</span><span class="op">$</span><span class="va">themeId</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Join this mapping with the theme summary table to get the labels</span></span>
<span><span class="va">node_theme_labels</span> <span class="op">&lt;-</span> <span class="va">node_themes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">theme_summary</span>, by <span class="op">=</span> <span class="st">"themeId"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finally, join the theme labels back to the main node table of our object</span></span>
<span><span class="va">nodes_with_themes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getNodeTable.html">getNodeTable</a></span><span class="op">(</span><span class="va">cm_obj_adv</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">node_theme_labels</span>, by <span class="op">=</span> <span class="st">"complexId"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update the ComplexMap object with this new node table</span></span>
<span><span class="va">cm_obj_adv</span><span class="op">$</span><span class="va">nodes</span> <span class="op">&lt;-</span> <span class="va">nodes_with_themes</span></span>
<span></span>
<span><span class="co"># Preview the new columns</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">cm_obj_adv</span><span class="op">$</span><span class="va">nodes</span>, <span class="va">complexId</span>, <span class="va">themeId</span>, <span class="va">themeLabel</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">complexId</th>
<th align="right">themeId</th>
<th align="left">themeLabel</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CpxMap_0359</td>
<td align="right">1</td>
<td align="left">BIOCARTA_PTDINS_PATHWAY</td>
</tr>
<tr class="even">
<td align="left">CpxMap_0414</td>
<td align="right">2</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
</tr>
<tr class="odd">
<td align="left">CpxMap_0508</td>
<td align="right">3</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
</tr>
<tr class="even">
<td align="left">CpxMap_0401</td>
<td align="right">4</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
</tr>
<tr class="odd">
<td align="left">CpxMap_0509</td>
<td align="right">5</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
</tr>
<tr class="even">
<td align="left">CpxMap_0090</td>
<td align="right">1</td>
<td align="left">BIOCARTA_PTDINS_PATHWAY</td>
</tr>
</tbody>
</table>
<p>Now that the <code>themeLabel</code> column exists in our node table,
we can query it.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find all complexes belonging to the "Proteasome" theme</span></span>
<span><span class="va">proteasome_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/queryMap.html">queryMap</a></span><span class="op">(</span><span class="va">cm_obj_adv</span>, query <span class="op">=</span> <span class="st">"BIOCARTA_PROTEASOME_PATHWAY"</span>, type <span class="op">=</span> <span class="st">"theme"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Found"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">proteasome_nodes</span><span class="op">)</span>, <span class="st">"nodes in the Proteasome theme."</span><span class="op">)</span></span>
<span><span class="co">#&gt; Found 310 nodes in the Proteasome theme.</span></span>
<span></span>
<span><span class="va">proteasome_nodes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">complexId</span>, <span class="va">primaryFunctionalDomain</span>, <span class="va">proteinCount</span>, <span class="va">betweenness</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">complexId</th>
<th align="left">primaryFunctionalDomain</th>
<th align="right">proteinCount</th>
<th align="right">betweenness</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CpxMap_0414</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">8</td>
<td align="right">0.1364494</td>
</tr>
<tr class="even">
<td align="left">CpxMap_0508</td>
<td align="left">Unenriched</td>
<td align="right">42</td>
<td align="right">0.1112882</td>
</tr>
<tr class="odd">
<td align="left">CpxMap_0401</td>
<td align="left">BIOCARTA_CACAM_PATHWAY</td>
<td align="right">6</td>
<td align="right">0.1003009</td>
</tr>
<tr class="even">
<td align="left">CpxMap_0509</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">102</td>
<td align="right">0.0917965</td>
</tr>
<tr class="odd">
<td align="left">CpxMap_0505</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">40</td>
<td align="right">0.0883700</td>
</tr>
<tr class="even">
<td align="left">CpxMap_0506</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">40</td>
<td align="right">0.0766518</td>
</tr>
<tr class="odd">
<td align="left">CpxMap_0454</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">9</td>
<td align="right">0.0659081</td>
</tr>
<tr class="even">
<td align="left">CpxMap_0182</td>
<td align="left">BIOCARTA_CACAM_PATHWAY</td>
<td align="right">4</td>
<td align="right">0.0656916</td>
</tr>
<tr class="odd">
<td align="left">CpxMap_0501</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">20</td>
<td align="right">0.0597822</td>
</tr>
<tr class="even">
<td align="left">CpxMap_0148</td>
<td align="left">BIOCARTA_PROTEASOME_PATHWAY</td>
<td align="right">4</td>
<td align="right">0.0572297</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Qingzhou Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
